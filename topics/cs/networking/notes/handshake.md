# π¤ TCP 3-Way & 4-Way ν•Έλ“μ…°μ΄ν¬

**TCPλ” μ—°κ²° μ§€ν–¥ν• ν”„λ΅ν† μ½λ΅, λ°μ΄ν„° μ „μ†΅ μ „ν›„μ— μ—°κ²° μ„¤μ •κ³Ό ν•΄μ λ¥Ό μ„ν• μ μ°¨κ°€ ν•„μ”ν•©λ‹λ‹¤.**  
μ΄λ¥Ό μ„ν•΄ **3-Way Handshake(μ—°κ²° μ„¤μ •)**, **4-Way Handshake(μ—°κ²° μΆ…λ£)** κ³Όμ •μ„ κ±°μΉ©λ‹λ‹¤.

---

## 1οΈβƒ£ 3-Way Handshake (μ—°κ²° μ„¤μ •)

> ν΄λΌμ΄μ–ΈνΈμ™€ μ„λ²„ κ°„μ— **μ‹ λΆ°μ„± μλ” μ—°κ²°μ„ μ„¤μ •**ν•κΈ° μ„ν• 3λ‹¨κ³„ μ μ°¨

#### κ³Όμ •

| λ‹¨κ³„ | μ†΅μ‹ μ      | μμ‹ μ      | μ„¤λ…                         |
|------|-------------|-------------|------------------------------|
| 1    | ν΄λΌμ΄μ–ΈνΈ β†’ | μ„λ²„        | `SYN` μ „μ†΅ (μ—°κ²° μ”μ²­)       |
| 2    | μ„λ²„ β†’       | ν΄λΌμ΄μ–ΈνΈ | `SYN + ACK` μ „μ†΅ (μλ½ μ‘λ‹µ) |
| 3    | ν΄λΌμ΄μ–ΈνΈ β†’ | μ„λ²„        | `ACK` μ „μ†΅ (μ—°κ²° μ™„λ£)       |

> μ—°κ²°μ΄ μ„¤μ •λλ©΄ μ–‘μ½ λ¨λ‘ λ°μ΄ν„° μ „μ†΅ κ°€λ¥

#### μμ‹ νλ¦„ (3-Way Handshake)

```
[ν΄λΌμ΄μ–ΈνΈ] ------> SYN ------> [μ„λ²„]
[ν΄λΌμ΄μ–ΈνΈ] <---- SYN+ACK <---- [μ„λ²„]
[ν΄λΌμ΄μ–ΈνΈ] ------> ACK ------> [μ„λ²„]
```

---

## 2οΈβƒ£ 4-Way Handshake (μ—°κ²° μΆ…λ£)

> TCP μ—°κ²°μ„ **μ–‘λ°©ν–¥μΌλ΅ μ•μ „ν•κ² μΆ…λ£**ν•κΈ° μ„ν• 4λ‹¨κ³„ μ μ°¨

#### κ³Όμ •

| λ‹¨κ³„ | μ†΅μ‹ μ      | μμ‹ μ      | μ„¤λ…                         |
|------|-------------|-------------|------------------------------|
| 1    | ν΄λΌμ΄μ–ΈνΈ β†’ | μ„λ²„        | `FIN` μ „μ†΅ (μΆ…λ£ μ”μ²­)       |
| 2    | μ„λ²„ β†’       | ν΄λΌμ΄μ–ΈνΈ | `ACK` μ „μ†΅ (μ”μ²­ μλ½)       |
| 3    | μ„λ²„ β†’       | ν΄λΌμ΄μ–ΈνΈ | `FIN` μ „μ†΅ (μ„λ²„λ„ μΆ…λ£ μ”μ²­)|
| 4    | ν΄λΌμ΄μ–ΈνΈ β†’ | μ„λ²„        | `ACK` μ „μ†΅ (μΆ…λ£ μλ½)       |

> μ΄ν›„ ν΄λΌμ΄μ–ΈνΈλ” μΌμ • μ‹κ°„ `TIME_WAIT` μƒνƒ μ μ§€

#### μμ‹ νλ¦„ (4-Way Handshake)

```
[ν΄λΌμ΄μ–ΈνΈ] ------> FIN ------> [μ„λ²„]
[ν΄λΌμ΄μ–ΈνΈ] <------ ACK <------ [μ„λ²„]
[ν΄λΌμ΄μ–ΈνΈ] <------ FIN <------ [μ„λ²„]
[ν΄λΌμ΄μ–ΈνΈ] ------> ACK ------> [μ„λ²„]
```

---

## 3οΈβƒ£ TIME_WAIT μƒνƒλ€?

> μ—°κ²° μΆ…λ£ ν›„ ν΄λΌμ΄μ–ΈνΈκ°€ **μ μ‹ λ€κΈ° μƒνƒλ¥Ό μ μ§€ν•λ” μ΄μ **

- μ§€μ—°λ ν¨ν‚· μ²λ¦¬ λ€λΉ„
- μ¬λ°”λ¥Έ μΆ…λ£ λ³΄μ¥ λ° μ¤‘λ³µ μ—°κ²° λ°©μ§€
- μ•½ **2 * MSL(Maximum Segment Lifetime)** λ™μ• μ μ§€

---

## 4οΈβƒ£ μ—°κ²° μ„¤μ • & μΆ…λ£ λΉ„κµ

| ν•­λ©         | 3-Way Handshake        | 4-Way Handshake         |
|--------------|------------------------|--------------------------|
| λ©μ          | μ—°κ²° μ„¤μ •               | μ—°κ²° μΆ…λ£                 |
| λ©”μ‹μ§€ μ    | 3κ°                     | 4κ°                       |
| FIN μ‚¬μ©     | X                      | O                         |
| ACK ν¬ν•¨     | O                      | O                         |
| λ°μ΄ν„° μ „μ†΅   | μ„¤μ • μ™„λ£ ν›„ κ°€λ¥       | μΆ…λ£ μ „κΉμ§€ κ°€λ¥          |

---

## π― μ •λ¦¬ μ”μ•½

β” **3-Way Handshake**: `SYN β†’ SYN+ACK β†’ ACK` β†’ μ—°κ²° μλ¦½  
β” **4-Way Handshake**: `FIN β†’ ACK β†’ FIN β†’ ACK` β†’ μ—°κ²° μΆ…λ£  
β” **TIME_WAIT** μƒνƒλ΅ μ§€μ—°λ ν¨ν‚· μ²λ¦¬ λ° μ•μ •μ„± ν™•λ³΄  
β” TCPλ” **μ‹ λΆ°μ„± μλ” μ—°κ²°κ³Ό μΆ…λ£λ¥Ό μ„ν• μ²΄κ³„μ μΈ μ μ°¨**λ¥Ό κ°€μ§
